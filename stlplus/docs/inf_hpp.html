<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>inf.hpp</title>
<meta http-equiv="generator" content="ccolour C++ colouriser by Andy Rushton">
</head>
<body lang="en">
<h1>inf.hpp</h1>
<pre style="background-color: #ffffff">

<span style="color: #990000">#ifndef</span> <span style="color: #000000">INF_HPP</span>
<span style="color: #990000">#define</span> <span style="color: #000000">INF_HPP</span>
<span style="color: #000099">/*------------------------------------------------------------------------------</span>
<span style="color: #000099"></span>
<span style="color: #000099">  Author:    Andy Rushton</span>
<span style="color: #000099">  Copyright: (c) Andy Rushton, 2004</span>
<span style="color: #000099">  License:   BSD License, see ../docs/license.html</span>
<span style="color: #000099"></span>
<span style="color: #000099">  An infinite-precision integer class</span>
<span style="color: #000099"></span>
<span style="color: #000099">  ------------------------------------------------------------------------------*/</span>
<span style="color: #990000">#include</span> <span style="color: #009900">"os_fixes.hpp"</span>
<span style="color: #990000">#include</span> <span style="color: #009900">&lt;string&gt;</span>
<span style="color: #990000">#include</span> <span style="color: #009900">&lt;stdexcept&gt;</span>
<span style="color: #990000">#include</span> <span style="color: #009900">"textio.hpp"</span>
<span style="color: #990000">#include</span> <span style="color: #009900">"string_utilities.hpp"</span>
<span style="color: #990000">#include</span> <span style="color: #009900">"persistent.hpp"</span>

<span style="color: #000099">////////////////////////////////////////////////////////////////////////////////</span>

<span style="color: #990000">class</span> <span style="color: #000000">inf</span>
<span style="color: #330033">{</span>
<span style="color: #990000">public</span><span style="color: #330033">:</span>
  <span style="color: #000099">// this class can throw the following exceptions:</span>
  <span style="color: #000099">//   std::out_of_range</span>
  <span style="color: #000099">//   std::overflow_error</span>
  <span style="color: #000099">//   std::invalid_argument</span>
  <span style="color: #000099">//   inf::divide_by_zero    // why doesn't std have this?</span>
  <span style="color: #000099">// all of these are derivations of the baseclass:</span>
  <span style="color: #000099">//   std::logic_error</span>
  <span style="color: #000099">// So you can catch all of them by catching the baseclass</span>
  <span style="color: #990000">class</span> <span style="color: #000000">divide_by_zero</span> <span style="color: #330033">:</span> <span style="color: #990000">public</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">logic_error</span> <span style="color: #330033">{</span>
  <span style="color: #990000">public</span><span style="color: #330033">:</span>
    <span style="color: #000000">divide_by_zero</span> <span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">what_arg</span><span style="color: #330033">)</span><span style="color: #330033">:</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">logic_error</span> <span style="color: #330033">(</span><span style="color: #000000">what_arg</span><span style="color: #330033">)</span> <span style="color: #330033">{</span> <span style="color: #330033">}</span>
  <span style="color: #330033">}</span><span style="color: #330033">;</span>

  <span style="color: #000099">//////////////////////////////////////////////////////////////////////////////</span>
  <span style="color: #000099">// constructors and assignments initialise the inf</span>
  <span style="color: #000099">// the void constructor initialises to zero, the others initialise to the value of the C integer type</span>
  <span style="color: #000099">// see also the section on string representations</span>

  <span style="color: #000000">inf</span><span style="color: #330033">(</span><span style="color: #990000">void</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
  <span style="color: #990000">explicit</span> <span style="color: #000000">inf</span><span style="color: #330033">(</span><span style="color: #990000">short</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
  <span style="color: #990000">explicit</span> <span style="color: #000000">inf</span><span style="color: #330033">(</span><span style="color: #990000">unsigned</span> <span style="color: #990000">short</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
  <span style="color: #990000">explicit</span> <span style="color: #000000">inf</span><span style="color: #330033">(</span><span style="color: #990000">int</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
  <span style="color: #990000">explicit</span> <span style="color: #000000">inf</span><span style="color: #330033">(</span><span style="color: #990000">unsigned</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
  <span style="color: #990000">explicit</span> <span style="color: #000000">inf</span><span style="color: #330033">(</span><span style="color: #990000">long</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
  <span style="color: #990000">explicit</span> <span style="color: #000000">inf</span><span style="color: #330033">(</span><span style="color: #990000">unsigned</span> <span style="color: #990000">long</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
  <span style="color: #990000">explicit</span> <span style="color: #000000">inf</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span><span style="color: #330033">)</span> <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">invalid_argument</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
  <span style="color: #000000">inf</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">inf</span><span style="color: #330033">&amp;</span><span style="color: #330033">)</span><span style="color: #330033">;</span>

  <span style="color: #330033">~</span><span style="color: #000000">inf</span><span style="color: #330033">(</span><span style="color: #990000">void</span><span style="color: #330033">)</span><span style="color: #330033">;</span>

  <span style="color: #000000">inf</span><span style="color: #330033">&amp;</span> <span style="color: #990000">operator</span> <span style="color: #330033">=</span> <span style="color: #330033">(</span><span style="color: #990000">short</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
  <span style="color: #000000">inf</span><span style="color: #330033">&amp;</span> <span style="color: #990000">operator</span> <span style="color: #330033">=</span> <span style="color: #330033">(</span><span style="color: #990000">unsigned</span> <span style="color: #990000">short</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
  <span style="color: #000000">inf</span><span style="color: #330033">&amp;</span> <span style="color: #990000">operator</span> <span style="color: #330033">=</span> <span style="color: #330033">(</span><span style="color: #990000">int</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
  <span style="color: #000000">inf</span><span style="color: #330033">&amp;</span> <span style="color: #990000">operator</span> <span style="color: #330033">=</span> <span style="color: #330033">(</span><span style="color: #990000">unsigned</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
  <span style="color: #000000">inf</span><span style="color: #330033">&amp;</span> <span style="color: #990000">operator</span> <span style="color: #330033">=</span> <span style="color: #330033">(</span><span style="color: #990000">long</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
  <span style="color: #000000">inf</span><span style="color: #330033">&amp;</span> <span style="color: #990000">operator</span> <span style="color: #330033">=</span> <span style="color: #330033">(</span><span style="color: #990000">unsigned</span> <span style="color: #990000">long</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
  <span style="color: #000000">inf</span><span style="color: #330033">&amp;</span> <span style="color: #990000">operator</span> <span style="color: #330033">=</span> <span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span><span style="color: #330033">)</span> <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">invalid_argument</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
  <span style="color: #000000">inf</span><span style="color: #330033">&amp;</span> <span style="color: #990000">operator</span> <span style="color: #330033">=</span> <span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">inf</span><span style="color: #330033">&amp;</span><span style="color: #330033">)</span><span style="color: #330033">;</span>

  <span style="color: #000099">//////////////////////////////////////////////////////////////////////////////</span>
  <span style="color: #000099">// conversions back to the C types - note that the inf must be in range for this to be legal</span>

  <span style="color: #990000">short</span> <span style="color: #000000">to_short</span><span style="color: #330033">(</span><span style="color: #990000">void</span><span style="color: #330033">)</span> <span style="color: #990000">const</span> <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">overflow_error</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
  <span style="color: #990000">unsigned</span> <span style="color: #990000">short</span> <span style="color: #000000">to_ushort</span><span style="color: #330033">(</span><span style="color: #990000">void</span><span style="color: #330033">)</span> <span style="color: #990000">const</span> <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">overflow_error</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
  <span style="color: #990000">int</span> <span style="color: #000000">to_int</span><span style="color: #330033">(</span><span style="color: #990000">void</span><span style="color: #330033">)</span> <span style="color: #990000">const</span> <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">overflow_error</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
  <span style="color: #990000">unsigned</span> <span style="color: #000000">to_unsigned</span><span style="color: #330033">(</span><span style="color: #990000">void</span><span style="color: #330033">)</span> <span style="color: #990000">const</span> <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">overflow_error</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
  <span style="color: #990000">unsigned</span> <span style="color: #000000">to_uint</span><span style="color: #330033">(</span><span style="color: #990000">void</span><span style="color: #330033">)</span> <span style="color: #990000">const</span> <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">overflow_error</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
  <span style="color: #990000">long</span> <span style="color: #000000">to_long</span><span style="color: #330033">(</span><span style="color: #990000">void</span><span style="color: #330033">)</span> <span style="color: #990000">const</span> <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">overflow_error</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
  <span style="color: #990000">unsigned</span> <span style="color: #990000">long</span> <span style="color: #000000">to_ulong</span><span style="color: #330033">(</span><span style="color: #990000">void</span><span style="color: #330033">)</span> <span style="color: #990000">const</span> <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">overflow_error</span><span style="color: #330033">)</span><span style="color: #330033">;</span>

  <span style="color: #000099">//////////////////////////////////////////////////////////////////////////////</span>
  <span style="color: #000099">// bitwise manipulation</span>

  <span style="color: #990000">void</span> <span style="color: #000000">resize</span><span style="color: #330033">(</span><span style="color: #990000">unsigned</span> <span style="color: #000000">bits</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
  <span style="color: #990000">void</span> <span style="color: #000000">reduce</span><span style="color: #330033">(</span><span style="color: #990000">void</span><span style="color: #330033">)</span><span style="color: #330033">;</span>

  <span style="color: #000099">// the number of significant bits in the value</span>
  <span style="color: #990000">unsigned</span> <span style="color: #000000">bits</span> <span style="color: #330033">(</span><span style="color: #990000">void</span><span style="color: #330033">)</span> <span style="color: #990000">const</span><span style="color: #330033">;</span>
  <span style="color: #990000">unsigned</span> <span style="color: #000000">size</span> <span style="color: #330033">(</span><span style="color: #990000">void</span><span style="color: #330033">)</span> <span style="color: #990000">const</span><span style="color: #330033">;</span>

  <span style="color: #000099">// the number of bits that can be accessed by the bit() method (=bits() rounded up to the next byte)</span>
  <span style="color: #990000">unsigned</span> <span style="color: #000000">indexable_bits</span><span style="color: #330033">(</span><span style="color: #990000">void</span><span style="color: #330033">)</span> <span style="color: #990000">const</span><span style="color: #330033">;</span>

  <span style="color: #990000">bool</span> <span style="color: #000000">bit</span> <span style="color: #330033">(</span><span style="color: #990000">unsigned</span> <span style="color: #000000">index</span><span style="color: #330033">)</span> <span style="color: #990000">const</span> <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">out_of_range</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
  <span style="color: #990000">bool</span> <span style="color: #990000">operator</span> <span style="color: #330033">[</span><span style="color: #330033">]</span> <span style="color: #330033">(</span><span style="color: #990000">unsigned</span> <span style="color: #000000">index</span><span style="color: #330033">)</span> <span style="color: #990000">const</span> <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">out_of_range</span><span style="color: #330033">)</span><span style="color: #330033">;</span>

  <span style="color: #990000">void</span> <span style="color: #000000">set</span> <span style="color: #330033">(</span><span style="color: #990000">unsigned</span> <span style="color: #000000">index</span><span style="color: #330033">)</span> <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">out_of_range</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
  <span style="color: #990000">void</span> <span style="color: #000000">clear</span> <span style="color: #330033">(</span><span style="color: #990000">unsigned</span> <span style="color: #000000">index</span><span style="color: #330033">)</span> <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">out_of_range</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
  <span style="color: #990000">void</span> <span style="color: #000000">preset</span> <span style="color: #330033">(</span><span style="color: #990000">unsigned</span> <span style="color: #000000">index</span><span style="color: #330033">,</span> <span style="color: #990000">bool</span> <span style="color: #000000">value</span><span style="color: #330033">)</span> <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">out_of_range</span><span style="color: #330033">)</span><span style="color: #330033">;</span>

  <span style="color: #000000">inf</span> <span style="color: #000000">slice</span><span style="color: #330033">(</span><span style="color: #990000">unsigned</span> <span style="color: #000000">low</span><span style="color: #330033">,</span> <span style="color: #990000">unsigned</span> <span style="color: #000000">high</span><span style="color: #330033">)</span> <span style="color: #990000">const</span> <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">out_of_range</span><span style="color: #330033">)</span><span style="color: #330033">;</span>

  <span style="color: #000099">//////////////////////////////////////////////////////////////////////////////</span>
  <span style="color: #000099">// tests for common values or ranges</span>

  <span style="color: #990000">bool</span> <span style="color: #000000">negative</span> <span style="color: #330033">(</span><span style="color: #990000">void</span><span style="color: #330033">)</span> <span style="color: #990000">const</span><span style="color: #330033">;</span>
  <span style="color: #990000">bool</span> <span style="color: #000000">natural</span> <span style="color: #330033">(</span><span style="color: #990000">void</span><span style="color: #330033">)</span> <span style="color: #990000">const</span><span style="color: #330033">;</span>
  <span style="color: #990000">bool</span> <span style="color: #000000">positive</span> <span style="color: #330033">(</span><span style="color: #990000">void</span><span style="color: #330033">)</span> <span style="color: #990000">const</span><span style="color: #330033">;</span>
  <span style="color: #990000">bool</span> <span style="color: #000000">zero</span> <span style="color: #330033">(</span><span style="color: #990000">void</span><span style="color: #330033">)</span> <span style="color: #990000">const</span><span style="color: #330033">;</span>
  <span style="color: #990000">bool</span> <span style="color: #000000">non_zero</span> <span style="color: #330033">(</span><span style="color: #990000">void</span><span style="color: #330033">)</span> <span style="color: #990000">const</span><span style="color: #330033">;</span>

  <span style="color: #000099">// tests used in if(i) and if(!i)</span>
<span style="color: #000099">//  operator bool (void) const;</span>
  <span style="color: #990000">bool</span> <span style="color: #990000">operator</span> <span style="color: #330033">!</span> <span style="color: #330033">(</span><span style="color: #990000">void</span><span style="color: #330033">)</span> <span style="color: #990000">const</span><span style="color: #330033">;</span>

  <span style="color: #000099">//////////////////////////////////////////////////////////////////////////////</span>
  <span style="color: #000099">// comparisons</span>

  <span style="color: #990000">friend</span> <span style="color: #990000">bool</span> <span style="color: #990000">operator</span> <span style="color: #330033">=</span><span style="color: #330033">=</span> <span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">inf</span><span style="color: #330033">&amp;</span><span style="color: #330033">,</span> <span style="color: #990000">const</span> <span style="color: #000000">inf</span><span style="color: #330033">&amp;</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
  <span style="color: #990000">friend</span> <span style="color: #990000">bool</span> <span style="color: #990000">operator</span> <span style="color: #330033">!</span><span style="color: #330033">=</span> <span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">inf</span><span style="color: #330033">&amp;</span><span style="color: #330033">,</span> <span style="color: #990000">const</span> <span style="color: #000000">inf</span><span style="color: #330033">&amp;</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
  <span style="color: #990000">friend</span> <span style="color: #990000">bool</span> <span style="color: #990000">operator</span> <span style="color: #330033">&lt;</span> <span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">inf</span><span style="color: #330033">&amp;</span><span style="color: #330033">,</span> <span style="color: #990000">const</span> <span style="color: #000000">inf</span><span style="color: #330033">&amp;</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
  <span style="color: #990000">friend</span> <span style="color: #990000">bool</span> <span style="color: #990000">operator</span> <span style="color: #330033">&lt;</span><span style="color: #330033">=</span> <span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">inf</span><span style="color: #330033">&amp;</span><span style="color: #330033">,</span> <span style="color: #990000">const</span> <span style="color: #000000">inf</span><span style="color: #330033">&amp;</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
  <span style="color: #990000">friend</span> <span style="color: #990000">bool</span> <span style="color: #990000">operator</span> <span style="color: #330033">&gt;</span> <span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">inf</span><span style="color: #330033">&amp;</span><span style="color: #330033">,</span> <span style="color: #990000">const</span> <span style="color: #000000">inf</span><span style="color: #330033">&amp;</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
  <span style="color: #990000">friend</span> <span style="color: #990000">bool</span> <span style="color: #990000">operator</span> <span style="color: #330033">&gt;</span><span style="color: #330033">=</span> <span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">inf</span><span style="color: #330033">&amp;</span><span style="color: #330033">,</span> <span style="color: #990000">const</span> <span style="color: #000000">inf</span><span style="color: #330033">&amp;</span><span style="color: #330033">)</span><span style="color: #330033">;</span>

  <span style="color: #000099">//////////////////////////////////////////////////////////////////////////////</span>
  <span style="color: #000099">// bitwise logic operations</span>

  <span style="color: #000000">inf</span><span style="color: #330033">&amp;</span> <span style="color: #000000">invert</span> <span style="color: #330033">(</span><span style="color: #990000">void</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
  <span style="color: #990000">friend</span> <span style="color: #000000">inf</span> <span style="color: #990000">operator</span> <span style="color: #330033">~</span> <span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">inf</span><span style="color: #330033">&amp;</span><span style="color: #330033">)</span><span style="color: #330033">;</span>

  <span style="color: #000000">inf</span><span style="color: #330033">&amp;</span> <span style="color: #990000">operator</span> <span style="color: #330033">&amp;</span><span style="color: #330033">=</span> <span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">inf</span><span style="color: #330033">&amp;</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
  <span style="color: #990000">friend</span> <span style="color: #000000">inf</span> <span style="color: #990000">operator</span> <span style="color: #330033">&amp;</span> <span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">inf</span><span style="color: #330033">&amp;</span><span style="color: #330033">,</span> <span style="color: #990000">const</span> <span style="color: #000000">inf</span><span style="color: #330033">&amp;</span><span style="color: #330033">)</span><span style="color: #330033">;</span>

  <span style="color: #000000">inf</span><span style="color: #330033">&amp;</span> <span style="color: #990000">operator</span> <span style="color: #330033">|</span><span style="color: #330033">=</span> <span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">inf</span><span style="color: #330033">&amp;</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
  <span style="color: #990000">friend</span> <span style="color: #000000">inf</span> <span style="color: #990000">operator</span> <span style="color: #330033">|</span> <span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">inf</span><span style="color: #330033">&amp;</span><span style="color: #330033">,</span> <span style="color: #990000">const</span> <span style="color: #000000">inf</span><span style="color: #330033">&amp;</span><span style="color: #330033">)</span><span style="color: #330033">;</span>

  <span style="color: #000000">inf</span><span style="color: #330033">&amp;</span> <span style="color: #990000">operator</span> <span style="color: #330033">^</span><span style="color: #330033">=</span> <span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">inf</span><span style="color: #330033">&amp;</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
  <span style="color: #990000">friend</span> <span style="color: #000000">inf</span> <span style="color: #990000">operator</span> <span style="color: #330033">^</span> <span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">inf</span><span style="color: #330033">&amp;</span><span style="color: #330033">,</span> <span style="color: #990000">const</span> <span style="color: #000000">inf</span><span style="color: #330033">&amp;</span><span style="color: #330033">)</span><span style="color: #330033">;</span>

  <span style="color: #000000">inf</span><span style="color: #330033">&amp;</span> <span style="color: #990000">operator</span> <span style="color: #330033">&lt;&lt;</span><span style="color: #330033">=</span> <span style="color: #330033">(</span><span style="color: #990000">unsigned</span> <span style="color: #000000">shift</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
  <span style="color: #990000">friend</span> <span style="color: #000000">inf</span> <span style="color: #990000">operator</span> <span style="color: #330033">&lt;&lt;</span> <span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">inf</span><span style="color: #330033">&amp;</span><span style="color: #330033">,</span> <span style="color: #990000">unsigned</span> <span style="color: #000000">shift</span><span style="color: #330033">)</span><span style="color: #330033">;</span>

  <span style="color: #000000">inf</span><span style="color: #330033">&amp;</span> <span style="color: #990000">operator</span> <span style="color: #330033">&gt;&gt;</span><span style="color: #330033">=</span> <span style="color: #330033">(</span><span style="color: #990000">unsigned</span> <span style="color: #000000">shift</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
  <span style="color: #990000">friend</span> <span style="color: #000000">inf</span> <span style="color: #990000">operator</span> <span style="color: #330033">&gt;&gt;</span> <span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">inf</span><span style="color: #330033">&amp;</span><span style="color: #330033">,</span><span style="color: #990000">unsigned</span> <span style="color: #000000">shift</span><span style="color: #330033">)</span><span style="color: #330033">;</span>

  <span style="color: #000099">//////////////////////////////////////////////////////////////////////////////</span>
  <span style="color: #000099">// arithmetic operations</span>

  <span style="color: #000000">inf</span><span style="color: #330033">&amp;</span> <span style="color: #000000">negate</span> <span style="color: #330033">(</span><span style="color: #990000">void</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
  <span style="color: #990000">friend</span> <span style="color: #000000">inf</span> <span style="color: #990000">operator</span> <span style="color: #330033">-</span> <span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">inf</span><span style="color: #330033">&amp;</span><span style="color: #330033">)</span><span style="color: #330033">;</span>

  <span style="color: #000000">inf</span><span style="color: #330033">&amp;</span> <span style="color: #000000">abs</span><span style="color: #330033">(</span><span style="color: #990000">void</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
  <span style="color: #990000">friend</span> <span style="color: #000000">inf</span> <span style="color: #000000">abs</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">inf</span><span style="color: #330033">&amp;</span><span style="color: #330033">)</span><span style="color: #330033">;</span>

  <span style="color: #000000">inf</span><span style="color: #330033">&amp;</span> <span style="color: #990000">operator</span> <span style="color: #330033">+</span><span style="color: #330033">=</span> <span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">inf</span><span style="color: #330033">&amp;</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
  <span style="color: #990000">friend</span> <span style="color: #000000">inf</span> <span style="color: #990000">operator</span> <span style="color: #330033">+</span> <span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">inf</span><span style="color: #330033">&amp;</span><span style="color: #330033">,</span> <span style="color: #990000">const</span> <span style="color: #000000">inf</span><span style="color: #330033">&amp;</span><span style="color: #330033">)</span><span style="color: #330033">;</span>

  <span style="color: #000000">inf</span><span style="color: #330033">&amp;</span> <span style="color: #990000">operator</span> <span style="color: #330033">-</span><span style="color: #330033">=</span> <span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">inf</span><span style="color: #330033">&amp;</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
  <span style="color: #990000">friend</span> <span style="color: #000000">inf</span> <span style="color: #990000">operator</span> <span style="color: #330033">-</span> <span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">inf</span><span style="color: #330033">&amp;</span><span style="color: #330033">,</span> <span style="color: #990000">const</span> <span style="color: #000000">inf</span><span style="color: #330033">&amp;</span><span style="color: #330033">)</span><span style="color: #330033">;</span>

  <span style="color: #000000">inf</span><span style="color: #330033">&amp;</span> <span style="color: #990000">operator</span> <span style="color: #330033">*</span><span style="color: #330033">=</span> <span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">inf</span><span style="color: #330033">&amp;</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
  <span style="color: #990000">friend</span> <span style="color: #000000">inf</span> <span style="color: #990000">operator</span> <span style="color: #330033">*</span> <span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">inf</span><span style="color: #330033">&amp;</span><span style="color: #330033">,</span> <span style="color: #990000">const</span> <span style="color: #000000">inf</span><span style="color: #330033">&amp;</span><span style="color: #330033">)</span><span style="color: #330033">;</span>

  <span style="color: #000000">inf</span><span style="color: #330033">&amp;</span> <span style="color: #990000">operator</span> <span style="color: #330033">/</span><span style="color: #330033">=</span> <span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">inf</span><span style="color: #330033">&amp;</span><span style="color: #330033">)</span> <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">divide_by_zero</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
  <span style="color: #990000">friend</span> <span style="color: #000000">inf</span> <span style="color: #990000">operator</span> <span style="color: #330033">/</span> <span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">inf</span><span style="color: #330033">&amp;</span><span style="color: #330033">,</span> <span style="color: #990000">const</span> <span style="color: #000000">inf</span><span style="color: #330033">&amp;</span><span style="color: #330033">)</span> <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">divide_by_zero</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
  <span style="color: #000000">inf</span><span style="color: #330033">&amp;</span> <span style="color: #990000">operator</span> <span style="color: #330033">%</span><span style="color: #330033">=</span> <span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">inf</span><span style="color: #330033">&amp;</span><span style="color: #330033">)</span> <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">divide_by_zero</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
  <span style="color: #990000">friend</span> <span style="color: #000000">inf</span> <span style="color: #990000">operator</span> <span style="color: #330033">%</span> <span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">inf</span><span style="color: #330033">&amp;</span><span style="color: #330033">,</span> <span style="color: #990000">const</span> <span style="color: #000000">inf</span><span style="color: #330033">&amp;</span><span style="color: #330033">)</span> <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">divide_by_zero</span><span style="color: #330033">)</span><span style="color: #330033">;</span>

  <span style="color: #000099">// combined division operator - returns the result pair(quotient,remainder) in one go</span>
  <span style="color: #990000">friend</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">pair</span><span style="color: #330033">&lt;</span><span style="color: #000000">inf</span><span style="color: #330033">,</span><span style="color: #000000">inf</span><span style="color: #330033">&gt;</span> <span style="color: #000000">divide</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">inf</span><span style="color: #330033">&amp;</span><span style="color: #330033">,</span> <span style="color: #990000">const</span> <span style="color: #000000">inf</span><span style="color: #330033">&amp;</span><span style="color: #330033">)</span> <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">divide_by_zero</span><span style="color: #330033">)</span><span style="color: #330033">;</span>

  <span style="color: #000099">//////////////////////////////////////////////////////////////////////////////</span>
  <span style="color: #000099">// pre- and post- increment and decrement</span>

  <span style="color: #000000">inf</span><span style="color: #330033">&amp;</span> <span style="color: #990000">operator</span> <span style="color: #330033">+</span><span style="color: #330033">+</span> <span style="color: #330033">(</span><span style="color: #990000">void</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
  <span style="color: #000000">inf</span> <span style="color: #990000">operator</span> <span style="color: #330033">+</span><span style="color: #330033">+</span> <span style="color: #330033">(</span><span style="color: #990000">int</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
  <span style="color: #000000">inf</span><span style="color: #330033">&amp;</span> <span style="color: #990000">operator</span> <span style="color: #330033">-</span><span style="color: #330033">-</span> <span style="color: #330033">(</span><span style="color: #990000">void</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
  <span style="color: #000000">inf</span> <span style="color: #990000">operator</span> <span style="color: #330033">-</span><span style="color: #330033">-</span> <span style="color: #330033">(</span><span style="color: #990000">int</span><span style="color: #330033">)</span><span style="color: #330033">;</span>

  <span style="color: #000099">//////////////////////////////////////////////////////////////////////////////</span>
  <span style="color: #000099">// string representation and I/O</span>

  <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span> <span style="color: #000000">image_debug</span><span style="color: #330033">(</span><span style="color: #990000">void</span><span style="color: #330033">)</span> <span style="color: #990000">const</span><span style="color: #330033">;</span>

  <span style="color: #000099">// conversion to a string representation - see string_utilities for an explanation of the arguments</span>
  <span style="color: #000099">// provided as a method and a friend</span>

  <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span> <span style="color: #000000">to_string</span><span style="color: #330033">(</span><span style="color: #990000">unsigned</span> <span style="color: #000000">radix</span> <span style="color: #330033">=</span> <span style="color: #993399">10</span><span style="color: #330033">,</span> <span style="color: #000000">radix_display_t</span> <span style="color: #000000">display</span> <span style="color: #330033">=</span> <span style="color: #000000">radix_c_style_or_hash</span><span style="color: #330033">,</span> <span style="color: #990000">unsigned</span> <span style="color: #000000">width</span> <span style="color: #330033">=</span> <span style="color: #993399">0</span><span style="color: #330033">)</span> <span style="color: #990000">const</span>
    <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">invalid_argument</span><span style="color: #330033">)</span><span style="color: #330033">;</span>

  <span style="color: #990000">friend</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span> <span style="color: #000000">to_string</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">inf</span><span style="color: #330033">&amp;</span> <span style="color: #000000">i</span><span style="color: #330033">,</span>
                               <span style="color: #990000">unsigned</span> <span style="color: #000000">radix</span> <span style="color: #330033">=</span> <span style="color: #993399">10</span><span style="color: #330033">,</span> <span style="color: #000000">radix_display_t</span> <span style="color: #000000">display</span> <span style="color: #330033">=</span> <span style="color: #000000">radix_c_style_or_hash</span><span style="color: #330033">,</span> <span style="color: #990000">unsigned</span> <span style="color: #000000">width</span> <span style="color: #330033">=</span> <span style="color: #993399">0</span><span style="color: #330033">)</span>
    <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">invalid_argument</span><span style="color: #330033">)</span><span style="color: #330033">;</span>

  <span style="color: #990000">friend</span> <span style="color: #000000">inf</span> <span style="color: #000000">to_inf</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span><span style="color: #330033">,</span> <span style="color: #990000">unsigned</span> <span style="color: #000000">radix</span> <span style="color: #330033">=</span> <span style="color: #993399">0</span><span style="color: #330033">)</span>
    <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">invalid_argument</span><span style="color: #330033">)</span><span style="color: #330033">;</span>

  <span style="color: #990000">friend</span> <span style="color: #000000">otext</span><span style="color: #330033">&amp;</span> <span style="color: #990000">operator</span> <span style="color: #330033">&lt;&lt;</span> <span style="color: #330033">(</span><span style="color: #000000">otext</span><span style="color: #330033">&amp;</span><span style="color: #330033">,</span> <span style="color: #990000">const</span> <span style="color: #000000">inf</span><span style="color: #330033">&amp;</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
  <span style="color: #990000">friend</span> <span style="color: #000000">itext</span><span style="color: #330033">&amp;</span> <span style="color: #990000">operator</span> <span style="color: #330033">&gt;&gt;</span> <span style="color: #330033">(</span><span style="color: #000000">itext</span><span style="color: #330033">&amp;</span><span style="color: #330033">,</span> <span style="color: #000000">inf</span><span style="color: #330033">&amp;</span><span style="color: #330033">)</span><span style="color: #330033">;</span>

  <span style="color: #000099">//////////////////////////////////////////////////////////////////////////////</span>
  <span style="color: #000099">// persistence</span>

  <span style="color: #990000">void</span> <span style="color: #000000">dump</span><span style="color: #330033">(</span><span style="color: #000000">dump_context</span><span style="color: #330033">&amp;</span><span style="color: #330033">)</span> <span style="color: #990000">const</span> <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">persistent_dump_failed</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
  <span style="color: #990000">void</span> <span style="color: #000000">restore</span><span style="color: #330033">(</span><span style="color: #000000">restore_context</span><span style="color: #330033">&amp;</span><span style="color: #330033">)</span> <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">persistent_restore_failed</span><span style="color: #330033">)</span><span style="color: #330033">;</span>

  <span style="color: #990000">friend</span> <span style="color: #990000">void</span> <span style="color: #000000">dump</span><span style="color: #330033">(</span><span style="color: #000000">dump_context</span><span style="color: #330033">&amp;</span> <span style="color: #000000">str</span><span style="color: #330033">,</span> <span style="color: #990000">const</span> <span style="color: #000000">inf</span><span style="color: #330033">&amp;</span> <span style="color: #000000">data</span><span style="color: #330033">)</span> <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">persistent_dump_failed</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
  <span style="color: #990000">friend</span> <span style="color: #990000">void</span> <span style="color: #000000">restore</span><span style="color: #330033">(</span><span style="color: #000000">restore_context</span><span style="color: #330033">&amp;</span> <span style="color: #000000">str</span><span style="color: #330033">,</span> <span style="color: #000000">inf</span><span style="color: #330033">&amp;</span> <span style="color: #000000">data</span><span style="color: #330033">)</span> <span style="color: #990000">throw</span><span style="color: #330033">(</span><span style="color: #000000">persistent_restore_failed</span><span style="color: #330033">)</span><span style="color: #330033">;</span>

  <span style="color: #000099">//////////////////////////////////////////////////////////////////////////////</span>
<span style="color: #990000">private</span><span style="color: #330033">:</span>
  <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span> <span style="color: #000000">m_data</span><span style="color: #330033">;</span>

  <span style="color: #990000">void</span> <span style="color: #000000">set_head</span><span style="color: #330033">(</span><span style="color: #990000">void</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #330033">}</span><span style="color: #330033">;</span>

<span style="color: #000099">////////////////////////////////////////////////////////////////////////////////</span>
<span style="color: #990000">#endif</span>
</pre>
</body>
</html>
