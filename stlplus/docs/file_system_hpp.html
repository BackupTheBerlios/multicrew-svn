<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>file_system.hpp</title>
<meta http-equiv="generator" content="ccolour C++ colouriser by Andy Rushton">
</head>
<body lang="en">
<h1>file_system.hpp</h1>
<pre style="background-color: #ffffff">

<span style="color: #990000">#ifndef</span> <span style="color: #000000">FILE_SYSTEM_HPP</span>
<span style="color: #990000">#define</span> <span style="color: #000000">FILE_SYSTEM_HPP</span>
<span style="color: #000099">/*------------------------------------------------------------------------------</span>
<span style="color: #000099"></span>
<span style="color: #000099">  Author:    Andy Rushton</span>
<span style="color: #000099">  Copyright: (c) Andy Rushton, 2004</span>
<span style="color: #000099">  License:   BSD License, see ../docs/license.html</span>
<span style="color: #000099"></span>
<span style="color: #000099">  Simplified access to the File system</span>
<span style="color: #000099"></span>
<span style="color: #000099">  All file system access and filename manipulation should be done</span>
<span style="color: #000099">  with this package. Then it is only necessary to port this package</span>
<span style="color: #000099">  to port all file handling.</span>
<span style="color: #000099"></span>
<span style="color: #000099">------------------------------------------------------------------------------*/</span>
<span style="color: #990000">#include</span> <span style="color: #009900">"os_fixes.hpp"</span>
<span style="color: #990000">#include</span> <span style="color: #009900">&lt;string&gt;</span>
<span style="color: #990000">#include</span> <span style="color: #009900">&lt;vector&gt;</span>
<span style="color: #990000">#include</span> <span style="color: #009900">&lt;time.h&gt;</span>

<span style="color: #000099">////////////////////////////////////////////////////////////////////////////////</span>
<span style="color: #000099">// classifying functions</span>

<span style="color: #990000">bool</span> <span style="color: #000000">is_present</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">thing</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #990000">bool</span> <span style="color: #000000">is_folder</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">thing</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #990000">bool</span> <span style="color: #000000">is_file</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">thing</span><span style="color: #330033">)</span><span style="color: #330033">;</span>

<span style="color: #000099">////////////////////////////////////////////////////////////////////////////////</span>
<span style="color: #000099">// file functions</span>

<span style="color: #990000">bool</span> <span style="color: #000000">file_exists</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">filespec</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #990000">bool</span> <span style="color: #000000">file_readable</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">filespec</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #990000">bool</span> <span style="color: #000000">file_writable</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">filespec</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #000000">size_t</span> <span style="color: #000000">file_size</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">filespec</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #990000">bool</span> <span style="color: #000000">file_delete</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">filespec</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #990000">bool</span> <span style="color: #000000">file_rename</span> <span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">old_filespec</span><span style="color: #330033">,</span> <span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">new_filespec</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #990000">bool</span> <span style="color: #000000">file_move</span> <span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">old_filespec</span><span style="color: #330033">,</span> <span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">new_filespec</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #990000">bool</span> <span style="color: #000000">file_copy</span> <span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">old_filespec</span><span style="color: #330033">,</span> <span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">new_filespec</span><span style="color: #330033">)</span><span style="color: #330033">;</span>

<span style="color: #000099">// Read-only versus read-write control. This is equivalent to chmod on Unix,</span>
<span style="color: #000099">// but I've insulated the user from the low-level routine because of</span>
<span style="color: #000099">// differences in the OSs' interpretation of the mode parameter. I've also</span>
<span style="color: #000099">// defined a new set of constants to control this, again because of</span>
<span style="color: #000099">// inconsistencies. The idea is to combine the constants as bit-masks so as to</span>
<span style="color: #000099">// build up a set of permissions. The modes are ORed together to build up a</span>
<span style="color: #000099">// set of permissions and then ANDed with a mask to control which people have</span>
<span style="color: #000099">// that permission. Permissions can be ORed together too. So, for example, to</span>
<span style="color: #000099">// give the owner read-write access and all others only read access, you would</span>
<span style="color: #000099">// use the expression:</span>
<span style="color: #000099">//   ((read_mode | write_mode) &amp; owner_mask) | (read_mode &amp; (group_mask | other_mask))</span>
<span style="color: #000099">// This can be simplified by using combined modes and combined masks to:</span>
<span style="color: #000099">//   (read_write_mode &amp; owner_mask) | (read_mode &amp; non_owner_mask)</span>

<span style="color: #000099">// basic modes</span>
<span style="color: #990000">extern</span> <span style="color: #990000">const</span> <span style="color: #990000">int</span> <span style="color: #000000">read__mode</span><span style="color: #330033">;</span>
<span style="color: #990000">extern</span> <span style="color: #990000">const</span> <span style="color: #990000">int</span> <span style="color: #000000">write_mode</span><span style="color: #330033">;</span>
<span style="color: #990000">extern</span> <span style="color: #990000">const</span> <span style="color: #990000">int</span> <span style="color: #000000">execute_mode</span><span style="color: #330033">;</span>
<span style="color: #000099">// combined modes</span>
<span style="color: #990000">extern</span> <span style="color: #990000">const</span> <span style="color: #990000">int</span> <span style="color: #000000">none_mode</span><span style="color: #330033">;</span>
<span style="color: #990000">extern</span> <span style="color: #990000">const</span> <span style="color: #990000">int</span> <span style="color: #000000">read_write_mode</span><span style="color: #330033">;</span>
<span style="color: #990000">extern</span> <span style="color: #990000">const</span> <span style="color: #990000">int</span> <span style="color: #000000">all_mode</span><span style="color: #330033">;</span>
<span style="color: #000099">// basic users</span>
<span style="color: #990000">extern</span> <span style="color: #990000">const</span> <span style="color: #990000">int</span> <span style="color: #000000">owner_mask</span><span style="color: #330033">;</span>
<span style="color: #990000">extern</span> <span style="color: #990000">const</span> <span style="color: #990000">int</span> <span style="color: #000000">group_mask</span><span style="color: #330033">;</span>
<span style="color: #990000">extern</span> <span style="color: #990000">const</span> <span style="color: #990000">int</span> <span style="color: #000000">other_mask</span><span style="color: #330033">;</span>
<span style="color: #000099">// combined users</span>
<span style="color: #990000">extern</span> <span style="color: #990000">const</span> <span style="color: #990000">int</span> <span style="color: #000000">non_owner_mask</span><span style="color: #330033">;</span>
<span style="color: #990000">extern</span> <span style="color: #990000">const</span> <span style="color: #990000">int</span> <span style="color: #000000">all_mask</span><span style="color: #330033">;</span>
<span style="color: #000099">// common settings</span>
<span style="color: #990000">extern</span> <span style="color: #990000">const</span> <span style="color: #990000">int</span> <span style="color: #000000">read_mode_all</span><span style="color: #330033">;</span>
<span style="color: #990000">extern</span> <span style="color: #990000">const</span> <span style="color: #990000">int</span> <span style="color: #000000">read_write_mode_owner_read_mode_all</span><span style="color: #330033">;</span>
<span style="color: #990000">extern</span> <span style="color: #990000">const</span> <span style="color: #990000">int</span> <span style="color: #000000">read_mode_owner_only</span><span style="color: #330033">;</span>
<span style="color: #990000">extern</span> <span style="color: #990000">const</span> <span style="color: #990000">int</span> <span style="color: #000000">read_write_mode_owner_only</span><span style="color: #330033">;</span>
<span style="color: #000099">// the function itself</span>
<span style="color: #990000">bool</span> <span style="color: #000000">file_set_mode</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">filespec</span><span style="color: #330033">,</span> <span style="color: #990000">int</span> <span style="color: #000000">mode</span><span style="color: #330033">)</span><span style="color: #330033">;</span>

<span style="color: #000099">// get the file's time stamps as a time_t - see the stlplus time.hpp package</span>
<span style="color: #000000">time_t</span> <span style="color: #000000">file_created</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">filespec</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #000000">time_t</span> <span style="color: #000000">file_modified</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">filespec</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #000000">time_t</span> <span style="color: #000000">file_accessed</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">filespec</span><span style="color: #330033">)</span><span style="color: #330033">;</span>

<span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span> <span style="color: #000000">create_filespec</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">folder</span><span style="color: #330033">,</span> <span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">filename</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span> <span style="color: #000000">create_filespec</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">folder</span><span style="color: #330033">,</span> <span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">basename</span><span style="color: #330033">,</span> <span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">extension</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span> <span style="color: #000000">create_filename</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">basename</span><span style="color: #330033">,</span> <span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">extension</span><span style="color: #330033">)</span><span style="color: #330033">;</span>

<span style="color: #000099">////////////////////////////////////////////////////////////////////////////////</span>
<span style="color: #000099">// folder functions</span>

<span style="color: #990000">bool</span> <span style="color: #000000">folder_create</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">folder</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #990000">bool</span> <span style="color: #000000">folder_exists</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">folder</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #990000">bool</span> <span style="color: #000000">folder_readable</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">folder</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #990000">bool</span> <span style="color: #000000">folder_writable</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">folder</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #990000">bool</span> <span style="color: #000000">folder_delete</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">folder</span><span style="color: #330033">,</span> <span style="color: #990000">bool</span> <span style="color: #000000">recurse</span> <span style="color: #330033">=</span> <span style="color: #990000">false</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #990000">bool</span> <span style="color: #000000">folder_rename</span> <span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">old_directory</span><span style="color: #330033">,</span> <span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">new_directory</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #990000">bool</span> <span style="color: #000000">folder_empty</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">folder</span><span style="color: #330033">)</span><span style="color: #330033">;</span>

<span style="color: #990000">bool</span> <span style="color: #000000">folder_set_current</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">folder</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span> <span style="color: #000000">folder_current</span><span style="color: #330033">(</span><span style="color: #990000">void</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span> <span style="color: #000000">folder_current_full</span><span style="color: #330033">(</span><span style="color: #990000">void</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span> <span style="color: #000000">folder_home</span><span style="color: #330033">(</span><span style="color: #990000">void</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span> <span style="color: #000000">folder_down</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">folder</span><span style="color: #330033">,</span> <span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">subfolder</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span> <span style="color: #000000">folder_up</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">folder</span><span style="color: #330033">,</span> <span style="color: #990000">unsigned</span> <span style="color: #000000">levels</span> <span style="color: #330033">=</span> <span style="color: #993399">1</span><span style="color: #330033">)</span><span style="color: #330033">;</span>

<span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">vector</span><span style="color: #330033">&lt;</span><span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&gt;</span> <span style="color: #000000">folder_subdirectories</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">folder</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">vector</span><span style="color: #330033">&lt;</span><span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&gt;</span> <span style="color: #000000">folder_files</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">folder</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">vector</span><span style="color: #330033">&lt;</span><span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&gt;</span> <span style="color: #000000">folder_all</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">folder</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">vector</span><span style="color: #330033">&lt;</span><span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&gt;</span> <span style="color: #000000">folder_wildcard</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">folder</span><span style="color: #330033">,</span> <span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">wildcard</span><span style="color: #330033">,</span> <span style="color: #990000">bool</span> <span style="color: #000000">subdirs</span> <span style="color: #330033">=</span> <span style="color: #990000">true</span><span style="color: #330033">,</span> <span style="color: #990000">bool</span> <span style="color: #000000">files</span> <span style="color: #330033">=</span> <span style="color: #990000">true</span><span style="color: #330033">)</span><span style="color: #330033">;</span>

<span style="color: #000099">////////////////////////////////////////////////////////////////////////////////</span>
<span style="color: #000099">// path functions</span>

<span style="color: #990000">bool</span> <span style="color: #000000">is_full_path</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">path</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #990000">bool</span> <span style="color: #000000">is_relative_path</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">path</span><span style="color: #330033">)</span><span style="color: #330033">;</span>

<span style="color: #000099">// convert to a full path relative to the root path</span>
<span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span> <span style="color: #000000">folder_to_path</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">root</span><span style="color: #330033">,</span> <span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">folder</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span> <span style="color: #000000">filespec_to_path</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">root</span><span style="color: #330033">,</span> <span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">filespec</span><span style="color: #330033">)</span><span style="color: #330033">;</span>

<span style="color: #000099">// convert to a full path relative to the current working directory</span>
<span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span> <span style="color: #000000">folder_to_path</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">folder</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span> <span style="color: #000000">filespec_to_path</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">filespec</span><span style="color: #330033">)</span><span style="color: #330033">;</span>

<span style="color: #000099">// convert to a relative path relative to the root path</span>
<span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span> <span style="color: #000000">folder_to_relative_path</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">root</span><span style="color: #330033">,</span> <span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">folder</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span> <span style="color: #000000">filespec_to_relative_path</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">root</span><span style="color: #330033">,</span> <span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">filespec</span><span style="color: #330033">)</span><span style="color: #330033">;</span>

<span style="color: #000099">// convert to a relative path relative to the current working directory</span>
<span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span> <span style="color: #000000">folder_to_relative_path</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">folder</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span> <span style="color: #000000">filespec_to_relative_path</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">filespec</span><span style="color: #330033">)</span><span style="color: #330033">;</span>

<span style="color: #000099">// append a folder separator to the path to make it absolutely clear that it is a folder</span>
<span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span> <span style="color: #000000">folder_append_separator</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">folder</span><span style="color: #330033">)</span><span style="color: #330033">;</span>

<span style="color: #000099">////////////////////////////////////////////////////////////////////////////////</span>
<span style="color: #000099">// access functions split a filespec into its elements</span>

<span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span> <span style="color: #000000">basename_part</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">filespec</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span> <span style="color: #000000">filename_part</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">filespec</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span> <span style="color: #000000">extension_part</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">filespec</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span> <span style="color: #000000">folder_part</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">filespec</span><span style="color: #330033">)</span><span style="color: #330033">;</span>

<span style="color: #000099">// split a path into a vector of elements - i.e. split at the folder separator</span>
<span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">vector</span><span style="color: #330033">&lt;</span><span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&gt;</span> <span style="color: #000000">folder_elements</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">folder</span><span style="color: #330033">)</span><span style="color: #330033">;</span>
<span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">vector</span><span style="color: #330033">&lt;</span><span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&gt;</span> <span style="color: #000000">filespec_elements</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">filespec</span><span style="color: #330033">)</span><span style="color: #330033">;</span>

<span style="color: #000099">////////////////////////////////////////////////////////////////////////////////</span>
<span style="color: #000099">// Path lookup functions</span>

<span style="color: #990000">#ifdef</span> <span style="color: #000000">_WIN32</span>
<span style="color: #990000">#define</span> <span style="color: #000000">PATH_SPLITTER</span> <span style="color: #009900">";"</span>
<span style="color: #990000">#else</span>
<span style="color: #990000">#define</span> <span style="color: #000000">PATH_SPLITTER</span> <span style="color: #009900">":"</span>
<span style="color: #990000">#endif</span>

<span style="color: #000099">// The lookup normally carried out by the shell to find a command in a</span>
<span style="color: #000099">// directory in the PATH. Give this function the name of a command and it</span>
<span style="color: #000099">// will return the full path. It returns an empty string on failure.</span>
<span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span> <span style="color: #000000">path_lookup</span> <span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">command</span><span style="color: #330033">)</span><span style="color: #330033">;</span>

<span style="color: #000099">// Generalised form of the above, takes a second argument</span>
<span style="color: #000099">// - the list to search. This can be used to do other path lookups,</span>
<span style="color: #000099">// such as LD_LIBRARY_PATH. The third argument specifies the splitter -</span>
<span style="color: #000099">// the default value of PATH_SPLITTER is appropriate for environment variables.</span>
<span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span> <span style="color: #000000">lookup</span> <span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">file</span><span style="color: #330033">,</span> <span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">path</span><span style="color: #330033">,</span> <span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">splitter</span> <span style="color: #330033">=</span> <span style="color: #000000">PATH_SPLITTER</span><span style="color: #330033">)</span><span style="color: #330033">;</span>

<span style="color: #000099">// utility function for finding the folder that contains the current executable</span>
<span style="color: #000099">// the argument is the argv[0] parameter passed to main</span>
<span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span> <span style="color: #000000">install_path</span><span style="color: #330033">(</span><span style="color: #990000">const</span> <span style="color: #000000">std</span><span style="color: #330033">::</span><span style="color: #000000">string</span><span style="color: #330033">&amp;</span> <span style="color: #000000">argv0</span><span style="color: #330033">)</span><span style="color: #330033">;</span>

<span style="color: #000099">////////////////////////////////////////////////////////////////////////////////</span>

<span style="color: #990000">#endif</span>
</pre>
</body>
</html>
